# Question 766
## Question
* A company’s developers want a secure way to gain SSH access on the company's Amazon EC2 instances that run the latest version of Amazon Linux. The developers work remotely and in the corporate oce.
* The company wants to use AWS services as a part of the solution. The EC2 instances are hosted in a VPC private subnet and access the internet through a NAT gateway that is deployed in a public subnet.
* What should a solutions architect do to meet these requirements MOST cost-eectively? 


## Options
* A. Create a bastion host in the same subnet as the EC2 instances. Grant the ec2:CreateVpnConnection IAM permission to the developers. Install EC2 Instance Connect so that the developers can connect to the EC2 instances.
* B. Create an AWS Site-to-Site VPN connection between the corporate network and the VPC. Instruct the developers to use the Site-to-Site VPN connection to access the EC2 instances when the developers are on the corporate network. Instruct the developers to set up another VPN connection for access when they work remotely.
* C. Create a bastion host in the public subnet of the VPConfigure the security groups and SSH keys of the bastion host to only allow connections and SSH authentication from the developers’ corporate and remote networks. Instruct the developers to connect through the bastion host by using SSH to reach the EC2 instances.
* D. Attach the AmazonSSMManagedInstanceCore IAM policy to an IAM role that is associated with the EC2 instances. Instruct the developers to use AWS Systems Manager Session Manager to access the EC2 instances

## Answer
* D.Attach the AmazonSSMManagedInstanceCore IAM policy to an IAM role that is associated with the EC2 instances. Instruct the developers to use AWS Systems Manager Session Manager to access the EC2 instances

## Explanation
* Asking for the most cost-effective and secure way for developers to gain SSH access to Amazon EC2 instances running Amazon Linux in a private subnet.
* Leverage AWS services and accommodate both remote and corporate office access.
  
1. A. Create a bastion host in the same subnet as the EC2 instances. Grant the ec2:CreateVpnConnection IAM permission to the developers. Install EC2 Instance Connect so that the developers can connect to the EC2 instances.
   * *Bastion host in the same subnet (Private Subnet)*: A bastion host should be in a public subnet to allow external access, then forward connections to private instances. Placing it in the same private subnet as the EC2 instances would defeat its purpose as a jump box for external access.
2. B. Create an AWS Site-to-Site VPN connection between the corporate network and the VPC. Instruct the developers to use the Site-to-Site VPN connection to access the EC2 instances when the developers are on the corporate network. Instruct the developers to set up another VPN connection for access when they work remotely.
   * *AWS Site-to-Site VPN connection*: Good solution for corporate network connectivity to the VPC, providing secure access for developers in the office.
   * *Another VPN connection for access when they work remotely*: Introduces complexity and potential cost with managing a separate VPN solution for remote developers
3. C. Create a bastion host in the public subnet of the VPConfigure the security groups and SSH keys of the bastion host to only allow connections and SSH authentication from the developers’ corporate and remote networks. Instruct the developers to connect through the bastion host by using SSH to reach the EC2 instances.
   * *Bastion host in public subnet*: This is a classic and secure architectural pattern for accessing instances in private subnets.
   * *Security group and SSH key configuration*: This is crucial for securing the bastion host, limiting access to known IP ranges (corporate and remote developer IPs) and using strong SSH key management.
4. **D. Attach the AmazonSSMManagedInstanceCore IAM policy to an IAM role that is associated with the EC2 instances. Instruct the developers to use AWS Systems Manager Session Manager to access the EC2 instances**
   * 


## Thinking
* Bastion Host 堡壘機 should be put in public subnet